[local ["Generate","Zip","Take","Times","Merge","Hamming","H","X","Y","Z","V","S","V1","F1"] [Take = proc {$ N F EXU1} [local ["EXU2"] [local ["EXU3","EXU4"] [EXU3 = N,EXU4 = 0,"Eq" "EXU3" "EXU4" "EXU2"],if EXU2 then [EXU1 = nil()] else [local ["X","G","PTU2"] [PTU2 = '#'(1:X 2:G),"F" "PTU2",local ["EXU3","EXU4"] [EXU3 = X,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = N,EXU8 = 1,"IntMinus" "EXU7" "EXU8" "EXU5"],EXU6 = G,"Take" "EXU5" "EXU6" "EXU4"],EXU1 = '|'(1:EXU3 2:EXU4)]]]]],Times = proc {$ N H EXU1} [EXU1 = proc {$ EXU2} [local ["X","G","PTU2"] [PTU2 = '#'(1:X 2:G),"H" "PTU2",local ["EXU3","EXU4"] [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = N,"IntMultiply" "EXU5" "EXU6" "EXU3"],local ["EXU5","EXU6"] [EXU5 = N,EXU6 = G,"Times" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],Merge = proc {$ Xs Ys EXU1} [EXU1 = proc {$ EXU2} [local ["X","G","PTU2"] [PTU2 = '#'(1:X 2:G),"Xs" "PTU2",local ["Y","Z","PTU2"] [PTU2 = '#'(1:Y 2:Z),"Ys" "PTU2",local ["EXU3"] [local ["EXU4","EXU5"] [EXU4 = X,EXU5 = Y,"LT" "EXU4" "EXU5" "EXU3"],if EXU3 then [local ["EXU4","EXU5"] [EXU4 = X,local ["EXU6","EXU7"] [EXU6 = G,EXU7 = Ys,"Merge" "EXU6" "EXU7" "EXU5"],EXU2 = '#'(1:EXU4 2:EXU5)]] else [local ["EXU4"] [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"GT" "EXU5" "EXU6" "EXU4"],if EXU4 then [local ["EXU5","EXU6"] [EXU5 = Y,local ["EXU7","EXU8"] [EXU7 = Xs,EXU8 = Z,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]] else [local ["EXU5","EXU6"] [EXU5 = X,local ["EXU7","EXU8"] [EXU7 = G,EXU8 = Z,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]]]]]]]]],Generate = proc {$ N EXU1} [EXU1 = proc {$ EXU2} [local ["EXU3","EXU4"] [EXU3 = N,local ["EXU5"] [local ["EXU6","EXU7"] [EXU6 = N,EXU7 = 1,"IntPlus" "EXU6" "EXU7" "EXU5"],"Generate" "EXU5" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]],Hamming = proc {$ N EXU1} [EXU1 = proc {$ EXU2} [local ["X","G","PTU2"] [PTU2 = '#'(1:X 2:G),"N" "PTU2",local ["EXU3","EXU4"] [EXU3 = 1,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = 2,local ["EXU9"] [EXU9 = G,"Hamming" "EXU9" "EXU8"],"Times" "EXU7" "EXU8" "EXU5"],local ["EXU7","EXU8"] [local ["EXU9","EXU10"] [EXU9 = 3,local ["EXU11"] [EXU11 = G,"Hamming" "EXU11" "EXU10"],"Times" "EXU9" "EXU10" "EXU7"],local ["EXU9","EXU10"] [EXU9 = 5,local ["EXU11"] [EXU11 = G,"Hamming" "EXU11" "EXU10"],"Times" "EXU9" "EXU10" "EXU8"],"Merge" "EXU7" "EXU8" "EXU6"],"Merge" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],local ["EXU1"] [EXU1 = 1,"Generate" "EXU1" "X"],local ["EXU1"] [EXU1 = X,"Hamming" "EXU1" "Y"],local ["EXU1","EXU2"] [EXU1 = 10,EXU2 = Y,"Take" "EXU1" "EXU2" "V"],skip/BV]]