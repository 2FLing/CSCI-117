[local ["Len","L","Out","GenList"] [GenList = proc {$ N L EXU1} [local ["EXU2"] [local ["EXU3","EXU4"] [EXU3 = N,EXU4 = 0,"Eq" "EXU3" "EXU4" "EXU2"],if EXU2 then [EXU1 = L] else [local ["EXU3","EXU4"] [local ["EXU5","EXU6"] [EXU5 = N,EXU6 = 1,"IntMinus" "EXU5" "EXU6" "EXU3"],local ["EXU5","EXU6"] [EXU5 = N,EXU6 = L,EXU4 = '|'(1:EXU5 2:EXU6)],"GenList" "EXU3" "EXU4" "EXU1"]]]],Len = proc {$ L A EXU1} [case L of nil() then [EXU1 = A] else [case L of '|'(1:H 2:T) then [local ["EXU2","EXU3"] [EXU2 = T,local ["EXU4","EXU5"] [EXU4 = A,EXU5 = 1,"IntPlus" "EXU4" "EXU5" "EXU3"],"Len" "EXU2" "EXU3" "EXU1"]] else [skip]]],local ["EXU1","EXU2"] [EXU1 = 1000,EXU2 = nil(),"GenList" "EXU1" "EXU2" "L"],local ["EXU1","EXU2"] [EXU1 = L,EXU2 = 0,"Len" "EXU1" "EXU2" "Out"],skip/BOut]]