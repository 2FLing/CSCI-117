[local ["NewQueue","S","B1","A1","A2","B2","V1","V2","V3","Out","Pu","Po","IsE","Av"] [NewQueue = proc {$ S EXU1} [local ["Front","Back","Size","Pu","Po","IsE","Av"] [local ["NCU2"] [NCU2 = 0,{NewCell NCU2 Size}],local ["NCU2"] [NCU2 = nil(),{NewCell NCU2 Front}],local ["NCU2"] [NCU2 = nil(),{NewCell NCU2 Back}],Pu = proc {$ N} [local ["EXU2"] [local ["EXU3","EXU4"] [{Exchange Size EXU3 EXU3},EXU4 = 0,"Eq" "EXU3" "EXU4" "EXU2"],if EXU2 then [local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = N,{Exchange Front EXU4 EXU4},SCU2 = '|'(1:EXU3 2:EXU4)],{Exchange Front GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = N,{Exchange Back EXU4 EXU4},SCU2 = '|'(1:EXU3 2:EXU4)],{Exchange Back GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange Size EXU3 EXU3},EXU4 = 1,"IntPlus" "EXU3" "EXU4" "SCU2"],{Exchange Size GarbU2 SCU2}]] else [local ["EXU2"] [local ["EXU3","EXU4"] [{Exchange Size EXU3 EXU3},EXU4 = S,"LT" "EXU3" "EXU4" "EXU2"],if EXU2 then [local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = N,{Exchange Back EXU4 EXU4},SCU2 = '|'(1:EXU3 2:EXU4)],{Exchange Back GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [{Exchange Size EXU3 EXU3},EXU4 = 1,"IntPlus" "EXU3" "EXU4" "SCU2"],{Exchange Size GarbU2 SCU2}]] else [local ["H","T","PTU1"] [PTU1 = '|'(1:H 2:T),{Exchange Front PTU1 PTU1},local ["H1","T1","PTU1"] [PTU1 = '|'(1:H1 2:T1),{Exchange Back PTU1 PTU1},local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = H1,EXU4 = T,SCU2 = '|'(1:EXU3 2:EXU4)],{Exchange Front GarbU2 SCU2}],local ["SCU2","GarbU2"] [local ["EXU3","EXU4"] [EXU3 = N,EXU4 = T1,SCU2 = '|'(1:EXU3 2:EXU4)],{Exchange Back GarbU2 SCU2}]]]]]]]],Po = proc {$ EXU2} [local ["EXU3"] [local ["EXU4","EXU5"] [{Exchange Size EXU4 EXU4},EXU5 = 1,"GT" "EXU4" "EXU5" "EXU3"],if EXU3 then [local ["H","T","PTU3"] [PTU3 = '|'(1:H 2:T),{Exchange Front PTU3 PTU3},local ["H1","T1","PTU3"] [PTU3 = '|'(1:H1 2:T1),{Exchange Back PTU3 PTU3},local ["SCU4","GarbU4"] [local ["EXU5","EXU6"] [EXU5 = H1,EXU6 = T,SCU4 = '|'(1:EXU5 2:EXU6)],{Exchange Front GarbU4 SCU4}],local ["SCU4","GarbU4"] [SCU4 = T1,{Exchange Back GarbU4 SCU4}],local ["SCU4","GarbU4"] [local ["EXU5","EXU6"] [{Exchange Size EXU5 EXU5},EXU6 = 1,"IntMinus" "EXU5" "EXU6" "SCU4"],{Exchange Size GarbU4 SCU4}],EXU2 = H]]] else [local ["EXU4"] [local ["EXU5","EXU6"] [{Exchange Size EXU5 EXU5},EXU6 = 1,"Eq" "EXU5" "EXU6" "EXU4"],if EXU4 then [local ["H","T","PTU4"] [PTU4 = '|'(1:H 2:T),{Exchange Front PTU4 PTU4},local ["SCU5","GarbU5"] [local ["EXU6","EXU7"] [{Exchange Size EXU6 EXU6},EXU7 = 1,"IntMinus" "EXU6" "EXU7" "SCU5"],{Exchange Size GarbU5 SCU5}],local ["SCU5","GarbU5"] [SCU5 = nil(),{Exchange Front GarbU5 SCU5}],local ["SCU5","GarbU5"] [SCU5 = nil(),{Exchange Back GarbU5 SCU5}],EXU2 = H]] else [skip]]]]],IsE = proc {$ EXU2} [local ["EXU3","EXU4"] [{Exchange Size EXU3 EXU3},EXU4 = 0,"Eq" "EXU3" "EXU4" "EXU2"]],Av = proc {$ EXU2} [local ["EXU3","EXU4"] [EXU3 = S,{Exchange Size EXU4 EXU4},"IntMinus" "EXU3" "EXU4" "EXU2"]],local ["EXU2","EXU3","EXU4","EXU5"] [EXU2 = Pu,EXU3 = Po,EXU4 = IsE,EXU5 = Av,EXU1 = ops(push:EXU2 pop:EXU3 isEmpty:EXU4 avail:EXU5)]]],local ["EXU1"] [EXU1 = 2,"NewQueue" "EXU1" "S"],local ["PTU0"] [PTU0 = ops(push:Pu pop:Po isEmpty:IsE avail:Av),PTU0 = S],"IsE" "B1","Av" "A1",local ["EXU1"] [EXU1 = 1,"Pu" "EXU1"],local ["EXU1"] [EXU1 = 2,"Pu" "EXU1"],"Av" "A2",local ["EXU1"] [EXU1 = 3,"Pu" "EXU1"],"IsE" "B2","Po" "V1","Po" "V2","Po" "V3",local ["EXU1","EXU2","EXU3","EXU4","EXU5","EXU6","EXU7"] [EXU1 = V1,EXU2 = V2,EXU3 = V3,EXU4 = B1,EXU5 = B2,EXU6 = A1,EXU7 = A2,local ["EXU8","EXU9"] [EXU8 = EXU1,local ["EXU10","EXU11"] [EXU10 = EXU2,local ["EXU12","EXU13"] [EXU12 = EXU3,local ["EXU14","EXU15"] [EXU14 = EXU4,local ["EXU16","EXU17"] [EXU16 = EXU5,local ["EXU18","EXU19"] [EXU18 = EXU6,local ["EXU20","EXU21"] [EXU20 = EXU7,EXU21 = nil(),EXU19 = '|'(1:EXU20 2:EXU21)],EXU17 = '|'(1:EXU18 2:EXU19)],EXU15 = '|'(1:EXU16 2:EXU17)],EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],Out = '|'(1:EXU8 2:EXU9)]],skip/BOut]]