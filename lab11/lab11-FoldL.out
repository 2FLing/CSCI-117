[local ["FoldLS","FoldL","Out1","Out2"] [FoldL = proc {$ F Z L EXU1} [case L of nil() then [EXU1 = Z] else [case L of '|'(1:H 2:T) then [local ["EXU2","EXU3","EXU4"] [EXU2 = F,local ["EXU5","EXU6"] [EXU5 = Z,EXU6 = H,"F" "EXU5" "EXU6" "EXU3"],EXU4 = T,"FoldL" "EXU2" "EXU3" "EXU4" "EXU1"]] else [skip]]],FoldLS = proc {$ F Z L EXU1} [local ["Helper","C","Out"] [local ["NCU2"] [NCU2 = Z,{NewCell NCU2 C}],Helper = proc {$ F C L EXU2} [case L of nil() then [{Exchange C EXU2 EXU2}] else [case L of '|'(1:H 2:T) then [local ["SCU3","GarbU3"] [local ["EXU4","EXU5"] [{Exchange C EXU4 EXU4},EXU5 = H,"F" "EXU4" "EXU5" "SCU3"],{Exchange C GarbU3 SCU3}],local ["EXU3","EXU4","EXU5"] [EXU3 = F,EXU4 = C,EXU5 = T,"Helper" "EXU3" "EXU4" "EXU5" "EXU2"]] else [skip]]],local ["EXU2","EXU3","EXU4"] [EXU2 = F,EXU3 = C,EXU4 = L,"Helper" "EXU2" "EXU3" "EXU4" "Out"],EXU1 = Out]],local ["EXU1","EXU2","EXU3"] [EXU1 = proc {$ X Y EXU4} [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"IntPlus" "EXU5" "EXU6" "EXU4"]],EXU2 = 3,local ["EXU4","EXU5","EXU6","EXU7"] [EXU4 = 1,EXU5 = 2,EXU6 = 3,EXU7 = 4,local ["EXU8","EXU9"] [EXU8 = EXU4,local ["EXU10","EXU11"] [EXU10 = EXU5,local ["EXU12","EXU13"] [EXU12 = EXU6,local ["EXU14","EXU15"] [EXU14 = EXU7,EXU15 = nil(),EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU3 = '|'(1:EXU8 2:EXU9)]],"FoldL" "EXU1" "EXU2" "EXU3" "Out1"],local ["EXU1","EXU2","EXU3"] [EXU1 = proc {$ X Y EXU4} [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"IntPlus" "EXU5" "EXU6" "EXU4"]],EXU2 = 3,local ["EXU4","EXU5","EXU6","EXU7"] [EXU4 = 1,EXU5 = 2,EXU6 = 3,EXU7 = 4,local ["EXU8","EXU9"] [EXU8 = EXU4,local ["EXU10","EXU11"] [EXU10 = EXU5,local ["EXU12","EXU13"] [EXU12 = EXU6,local ["EXU14","EXU15"] [EXU14 = EXU7,EXU15 = nil(),EXU13 = '|'(1:EXU14 2:EXU15)],EXU11 = '|'(1:EXU12 2:EXU13)],EXU9 = '|'(1:EXU10 2:EXU11)],EXU3 = '|'(1:EXU8 2:EXU9)]],"FoldLS" "EXU1" "EXU2" "EXU3" "Out2"],skip/BOut1,skip/BOut2]]